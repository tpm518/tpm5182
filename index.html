<!DOCTYPE html>
<head>
  <title>Sentiment Analysis by Book</title>
  <meta charset="utf-8">
  <script type="text/javascript" src="../lib/d3.v5.min.js"></script>
  <script type="text/javascript" src="../lib/d3-dsv.min.js"></script>
  <script type="text/javascript" src= "../lib/d3-legend.min.js"></script>
  <script type="text/javascript" src= "../lib/d3-geo-projection.v2.min.js"></script>
  <script type="text/javascript" src= "../lib/d3-tip.min.js"></script>
  <script type="text/javascript" src= "../lib/topojson.v2.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">


  <style>

.legend {
  display: table;
  margin: 0 auto;
  font-family: "Helvetica Neue", sans-serif;
  font-size: 12px;
  height: 90px;
  width: 250px;
}
p, li {
    margin-top: 3px;
  margin-bottom: 3px; /* between paragraphs */
  font-family: "apercu",sans-serif; /*  "Arial Rounded MT";*/
  }


  .d3-tip {
    line-height: 1.5;
    font-weight: 400;
    font-family: "Arial Rounded MT Bold";
    padding: 6px;
    background: rgba(0, 0, 0, 0.6);
    color: #3cff00;
    border-radius: 1px;
    pointer-events: none;
  }

  .dropdowns, text ,  label{
    font-family: "Google Sans", "Open Sans", Arial, Helvetica, sans-serif;
}


body {
    display: block;
    margin: 20px;
}
.title {
    text-align: center;
    color:#793030;
    font-size: xx-large;
    font-family: "Arial Rounded MT Bold";
    margin-bottom: 4px;
}

.names {
    text-align: center;
    color: #000000;
    font-size: large;
    font-family: "Arial Rounded MT Bold";
    margin-bottom: 4px;
}


#myInput {
  box-sizing: border-box;
  background-image: url('searchicon.png');
  background-position: 14px 12px;
  background-repeat: no-repeat;
  font-size: 16px;
  padding: 14px 20px 12px 45px;
  border: none;
  border-bottom: 1px solid #ddd;
  width: 300px;
}

/* The search field when it gets focus/clicked on */
#myInput:focus {outline: 3px solid #ddd;}

/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f6f6f6;
  min-width: 230px;
  border: 1px solid #ddd;
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #f1f1f1}

/* Show the dropdown menu (use JS to add this class to the .dropdown-content container when the user clicks on the dropdown button) */
.show {display:block;}




.dropdown {
  background-image: url('/css/searchicon.png'); /* Add a search icon to input */
  background-position: 10px 12px; /* Position the search icon */
  background-repeat: no-repeat; /* Do not repeat the icon image */
  width: 300px; /* Full-width */
  font-size: 16px; /* Increase font-size */
  /* padding: 12px 20px 12px 40px; /* Add some padding */
  /* border: 1px solid #ddd; Add a grey border */ 
  margin-bottom: 12px; /* Add some space below the input */
}


.dropbtn {
  background-image: url('/css/searchicon.png'); /* Add a search icon to input */
  background-position: 10px 12px; /* Position the search icon */
  background-repeat: no-repeat; /* Do not repeat the icon image */
  width: 300px; /* Full-width */
  font-size: 16px; /* Increase font-size */
  padding: 12px 20px 12px 40px; /* Add some padding */
  border: 1px solid #ddd; /* Add a grey border */
  margin-bottom: 12px; /* Add some space below the input */
}
  </style>
</head>

<body style="background-attachment: fixed; width: 1200px;">

	<head style="width: 758px"> 
        <br>
        <h1 class="title" style=" width: 757px">Sentiment Analysis by Book</h1>
      </head>
      <br>

      <div class="dropdown">

        <button onclick="myFunction()" class="dropbtn"><strong>Click Here to Select a Book</strong></button>
        <div id="myDropdown" class="dropdown-content">
          <input type="text" placeholder="Search for a book..." id="myInput" onkeyup="filterFunction()">

        </div>
      </div>
  
      <br>
      
      <h3 id = "TotalTitle" style="text-align: left; font-weight: bold;  font-family: Arial Rounded MT Bold;"></h3>
      <br>
      <table style="width: 758px">
    <tbody>
        <tr>
        <td rowspan="8" style="width: 241px; text-align: center">
            <img alt height="300" width="199" id="coverImage" style = "border: none"  >
        </td>

        <td rowspan="8" style="width: 260px; text-align: left; font-size: 1.3em">
           
            <p id = "Title" margin="2px">  </p>
            <p id = "Author"> </p>
            <p id = "ISBN13" > </p>
            <p id = "PublishedDate" > </p>
            <p id = "NumPages" > </p>
            <p id = "AvgRtg" > </p>
            
            
            <p id = "Price" > </p>
            <p ><a id = "BuyLink" href=""></a></p>
          
        </td>

        <td rowspan="8" style="width: 150px; text-align: left; font-size: 1.3em">
            <p id = "TopEmotion" style="text-align: center;  color: #006600"></p>
            <ol id = "TopEmotionlist">
        
              </ol>
        </td>
    </tr>

    </tbody>
    </table>
 
    <br>
    <br>
   <div id="bookinfo">

    <p id = "Descriptionhead" style="text-align: left; font-weight: bold; font-size: large; font-family: Arial Rounded MT Bold;"></p>
    <p id = "Description" style="width: 750px"></p>
    <br>
    <br>
    </div>
    
    <div id="container">
        <div id ='leftrowlist'>   </div>
    <div class="row content">
    
        <div class="col-lg-7 text-left" id ='leftrow'>   </div>
        <div class="col-sm-12 col-md-12 col-lg-4 sidenav" id ='rightrow'></div>

    </div> </div>

    <div id="container">
        <div id ='leftrowlist2'>   </div>
    <div class="row content">
    
        <div class="col-lg-7 text-left" id ='leftrow2'>   </div>
        <div class="col-sm-12 col-md-12 col-lg-4 sidenav" id ='rightrow2'></div>

    </div> </div>


<script>

// Function for toggling the dropdown list and reduing the search list
function myFunction() {
  document.getElementById("myDropdown").classList.toggle("show");
}

function filterFunction() {
  var input, filter, ul, li, a, i;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase();
  div = document.getElementById("myDropdown");
  a = div.getElementsByTagName("a");
  for (i = 0; i < a.length; i++) {
    txtValue = a[i].textContent || a[i].innerText;
    if (txtValue.toUpperCase().indexOf(filter) > -1) {
      a[i].style.display = "";
    } else {
      a[i].style.display = "none";
    }
  }
}

    var svgWidth = 650;
    var svgHeight = 400;
    
    var chartMargin = {
    top: 30,
    right: 30,
    bottom: 30,
    left: 30
    };

    const tip = d3.tip()
                .attr('class', 'd3-tip')
                .offset([-10, 0])
                .html(function(d,i) {
          return (`<strong>Chunk: ${i+1}<strong><br>Value: ${d}`);});      
             //  
   
    var colorScale = d3.schemeCategory10;
    // create scales x & y for X and Y axis and set their ranges
    var yLinearScale = d3.scaleLinear()
      .range([350, 25]);

    var XLinearScale = d3.scaleLinear()
      .range([100, 600]);
     


    var svglist = d3
    .select("#leftrowlist")
    .append("svg")
    .attr("height", 140)
    .attr("width", 1000)
    .append("g")
    .attr("transform", "translate(" + 10 + "," + 10 + ")")
    .attr("class", "svg");

    var svg = d3 //emotion svg for book
    .select("#leftrow")
    .append("svg")
    .attr("height", 450)
    .attr("width", 770)
    .append("g")
    .attr('preserveAspectRatio',"xMinYMid")
    .attr("transform", "translate(" + chartMargin.left + "," + chartMargin.top + ")")
    .attr("class", "svg");

    var svg2 = d3  //emotion svg for compare book
    .select("#rightrow")
    .append("svg")
    .attr("height", 450)
    .attr("width", 1000)
    .attr('preserveAspectRatio',"xMaxYMid")
    .append("g")
    .attr("transform", "translate(" + chartMargin.left + "," + chartMargin.top + ")")
    .attr("class", "svg");


    var svg3 = d3  //pos/neg svg for book
    .select("#leftrow2")
    .append("svg")
    .attr("height", 450)
    .attr("width", 770)
    .append("g")
    .attr('preserveAspectRatio',"xMinYMid")
    .attr("transform", "translate(" + chartMargin.left + "," + chartMargin.top + ")")
    .attr("class", "svg");

    var svg4 = d3 //pos/neg svg for compare book
    .select("#rightrow2")
    .append("svg")
    .attr("height", 450)
    .attr("width", 1000)
    .attr('preserveAspectRatio',"xMaxYMid")
    .append("g")
    .attr("transform", "translate(" + chartMargin.left + "," + chartMargin.top + ")")
    .attr("class", "svg");

    svg.call(tip);
    svg2.call(tip);
    XLinearScale.domain([0,20]);

//	var pathToCsv = "testschemawithisbn.csv";		// path to csv
    var pathToCsv = "FINAL DATAFRAME.csv";	

//genrates page for the selected book
    function creategraph(data, selectedbook, allemotions, elem){ 
        d3.selectAll("path.line").remove();
        d3.selectAll("text").remove();
        d3.selectAll("circle").remove();
        d3.selectAll("#leftaxis").remove();
        d3.selectAll("#bottomaxis").remove();
        d3.selectAll("li").remove();
        d3.selectAll("b").remove();
        d3.selectAll("span").remove();
        d3.select("#Descriptionhead").text("");
       
       
        var mydata = data.filter(function(d) { return d.Title == selectedbook; });
        mydata = mydata.slice(0,20);
        console.log(mydata)
        var apidata = mydata[0];
        var isbn = apidata["ISBN13"].split("'");
        isbn = isbn[isbn.length-2];

        d3.select("#TotalTitle").text(apidata['Title']);
       d3.select("#Title").data(["Title: "]).append('b').text(function (d) { return d; }).style("color", "#006600");
       d3.select("#Title").data([apidata["Title"]]).append('span').text(function (d) { return d; })
      // d3.select("#Title").text(" Title: " + apidata["Title"]);


      d3.select("#Author").data(["Author: "]).append('b').text(function (d) { return d; }).style("color", "#006600");
      d3.select("#Author").data([apidata["Author"]]).append('span').text(function (d) { return d; })
       // d3.select("#Author").text(" Author: " + apidata["Author"]);

       
      d3.select("#ISBN13").data(["ISBN: "]).append('b').text(function (d) { return d; }).style("color", "#006600");
      d3.select("#ISBN13").data([isbn]).append('span').text(function (d) { return d; })
   //     d3.select("#ISBN13").text(" ISBN: " + isbn);

     d3.select("#PublishedDate").data(["Published Date: "]).append('b').text(function (d) { return d; }).style("color", "#006600");
      d3.select("#PublishedDate").data([apidata["PublishedDate"]]).append('span').text(function (d) { return d; })
       // if(apidata["PublishedDate"] != ""){d3.select("#PublishedDate").text(" Published Date: " + apidata["PublishedDate"]);}
       //     else{d3.select("#PublishedDate").text("");};

    if(apidata["NumPages"] != ""){d3.select("#NumPages").data(["NumPages: "]).append('b').text(function (d) { return d; }).style("color", "#006600");
      d3.select("#NumPages").data([apidata["NumPages"]]).append('span').text(function (d) { return d; })}
    else{d3.select("#NumPages").data(["NumPages: "]).append('b').text(function (d) { return ""; });
      d3.select("#NumPages").data([apidata["NumPages"]]).append('span').text(function (d) { return ""; })};
     //   if(apidata["NumPages"] != ""){d3.select("#NumPages").text(" Number of Pages: " + apidata["NumPages"])}
      //       else{d3.select("#NumPages").text("");};

      if(apidata["AvgRtg"] != ""){d3.select("#AvgRtg").data(["Avg Rating: "]).append('b').text(function (d) { return d; }).style("color", "#006600");
      d3.select("#AvgRtg").data([apidata["AvgRtg"]]).append('span').text(function (d) { return d; })}
    else{d3.select("#AvgRtg").data(["AvgRtg: "]).append('b').text(function (d) { return ""; });
      d3.select("#AvgRtg").data([apidata["AvgRtg"]]).append('span').text(function (d) { return ""; })};
      //  if(apidata["AvgRtg"] != ""){d3.select("#AvgRtg").text(" Rating: " + apidata["AvgRtg"]);}
      //      else{d3.select("#AvgRtg").text("");};
      
        if(apidata["Description"] != ""){d3.select("#Description").text( apidata["Description"]);}
            else{d3.select("#Description").text("");};

        if(apidata["BuyLink"] != ""){d3.select("#BuyLink").text(" Click here to buy");
        d3.select("#BuyLink").on("click", function() { window.open(apidata["BuyLink"]); });}
             else{d3.select("#BuyLink").text("");};
        if( apidata["Description"] != ""){
        d3.select("#Descriptionhead").text("Description");};


    if(apidata["Price"] != ""){d3.select("#Price").data(["Price: "]).append('b').text(function (d) { return d; }).style("color", "#006600");
      d3.select("#Price").data([apidata["Price"] + " " + apidata["Currency"]]).append('span').text(function (d) { return d; })}
    else{d3.select("#Price").data(["Price: "]).append('b').text(function (d) { return ""; });
      d3.select("#Price").data([apidata["Price"]]).append('span').text(function (d) { return ""; })};


        d3.select("#TopEmotion").append('b').text("Top Emotions:");
  

        d3.select("#TopEmotionlist")
      .selectAll('myOptions')
     	.data([apidata["TopEmotion1"], apidata["TopEmotion2"], apidata["TopEmotion3"]])
      .enter()
    	.append('li')
      .text(function (d) { return d; }) // text showed in the menu
      .attr("value", function (d) { return d; });



    svglist.append("text")     
                    .attr("x", -5 )
                    .attr("y",  15 )
                    .style("text-anchor", "left")
                    .style("font-family", "Arial Rounded MT Bold")
                    .style("font-size", "1.3em")
                    .text("Most Similar Books");
  //  var topemotionlist = [apidata["TopEmotion1"], apidata["TopEmotion2"], apidata["TopEmotion3"]];
    var similarbooklist = [apidata["Similar1"], apidata["Similar2"], apidata["Similar3"]];
 

    var listspacing = 0; 
    // add Open and Compare features for most similar books
    console.log(similarbooklist);
    var xx = data.filter(function(dd) { return dd.Title == similarbooklist[0]; });
    console.log(xx);
    similarbooklist.forEach(function(simbook){
        svglist.append("text")     
                    .attr("x", 120 )
                    .attr("y",  listspacing*20+40 )
                    .style("font-family", "Arial Rounded MT")
                    .style("text-anchor", "left")
                    .style("font-size", "1.3em")
                    .text(  data.filter(function(dd) { return dd.Title == simbook; })[0]['Title'].slice(0,60))


        svglist.append("text")     
                    .attr("x", 50 )
                    .attr("y",  listspacing*20+40 )
                   .attr("id", data.filter(function(dd) { return dd.Title == simbook; })[0]['Title']+"Compare")
                    .style("text-anchor", "left")
                    .attr("text-decoration", "underline")
                    .style("stroke", "blue")
                    .style("font-size", ".9em")
                    .text(  "Compare")
                    .on('mouseover',function(d,i){

                            d3.select(this)
                            .style("stroke", "red");})
                    .on('mouseout',function(d,i){

                                d3.select(this)
                                .style("stroke", "blue");})
                    .on('click',function(d,i){

                                d3.select(this)
                                .style("color", "blue");

                                    createsvggraph(data, this["id"].slice(0,-7), allemotions, svg2)
                                    createsvggraph(data, this["id"].slice(0,-7), ["positive", "negative"], svg4);})


        svglist.append("text")      
                    .attr("x", 5 )
                    .attr("y",  listspacing*20+40 )
                    .attr("id", data.filter(function(dd) { return dd.Title == simbook; })[0]['Title']+"Open")
                    .style("text-anchor", "left")
                    .attr("text-decoration", "underline")
                    .style("stroke", "blue")
                    .style("font-size", ".9em")
                    .text("Open")
                    .on('mouseover',function(d,i){

                            d3.select(this)
                            .style("stroke", "red");})
                    .on('mouseout',function(d,i){

                        d3.select(this)
                        .style("stroke", "blue");})
                    .on('click',function(d,i){

                        d3.select(this)
                        .style("color", "blue");

                    creategraph(data, this["id"].slice(0,-4), allemotions, svg);
                    var dd=document.getElementById("dropdowns")
        var aryOptions=dd.getElementsByTagName('option');
        var cpt=0;
        var indexValue=false;
        for(cpt=0;cpt<aryOptions.length;cpt++){
        if(aryOptions[cpt].textContent==this["id"].slice(0,-4)){
            indexValue=cpt;
        }
        };
        dd.selectedIndex=indexValue;

})


                    listspacing = listspacing +1;
    });

        document.getElementById("coverImage").src = apidata["ImgURL"];

        createsvggraph(data, selectedbook, allemotions, elem);
        createsvggraph(data, selectedbook, ["positive", "negative"], svg3);


   }

//creates svg graph for a specific book and element
   function createsvggraph(data, selectedbook, allemotions, elem){ 
        elem.selectAll("path.line").remove();
        elem.selectAll("text").remove();
        elem.selectAll("circle").remove();
        elem.selectAll("#leftaxis").remove();
        elem.selectAll("#bottomaxis").remove();
    var mydata = data.filter(function(d) { return d.Title == selectedbook; });
    mydata = mydata.slice(0,20);
        var apidata = mydata[0];
    mycolor = 0;
        var ylegend = 40;
        var maxylegend = 0;
        allemotions.forEach(function(myemotion){
            if ((d3.extent(mydata, d => d[myemotion])[1])>maxylegend){
                maxylegend = d3.extent(mydata, d => d[myemotion])[1]
            };
        });

        yLinearScale.domain([0,maxylegend+.03]);

        allemotions.forEach(function(myemotion){
          
            emotion = mydata.map(value => value[myemotion]);
            chunk = mydata.map(value => value.chunk);

            var lineFunc = d3.line()
            .x(function(d, index) {
            return XLinearScale(index+1);
            })
            .y(function(d) {
            return yLinearScale(d);
            });


            elem.append("path")
            .data(emotion)
            .attr("class", "line")
            .attr("fill", "none")
            .attr("id", myemotion)
            .style("stroke", colorScale[mycolor])
            .style('stroke-width', '1px')
            .attr('d', lineFunc(emotion));

            
            elem.selectAll("dot")
            .data(emotion)
            .enter().append("circle")
            .attr("r", 4)
            .attr("fill", colorScale[mycolor])
            .attr("cx", XLinearScale(20) + 40)
            .attr("cy", ylegend)
            .style('opacity', 0.7)
            .style('stroke-width', 0.3);

            elem.append("text")      
            .attr("x", XLinearScale(20) + 55)
            .attr("y", ylegend) 
            .attr("id", myemotion+"legend")
            .style("stroke", colorScale[mycolor])
            .style("text-anchor", "left")
            .style("alignment-baseline", "central")
            .text(myemotion)
            .on('mouseover',function(d,i){

                d3.select(this)
                .style('opacity', 1)
                .style("stroke", "black");
              
                
                d3.selectAll("path.line")
                .style("opacity", .2);

                d3.selectAll("circle")
                .style("opacity", .2);

                d3.selectAll("#"+this['id'].slice(0,-6))
                .style("opacity", 1)
                .style('stroke-width', '2px');


                d3.selectAll("#"+this['id'].slice(0,-6)+"dot")
                .style("opacity", 1);
            })
            .on('mouseout', function(d){
                d3.select(this)
                .style('opacity', 1)
                .style("stroke", colorScale[allemotions.indexOf(this['id'].slice(0,-6))]);

                d3.selectAll("path.line")
                .style("opacity", 1)
                .style('stroke-width', '1px');

                d3.selectAll("circle")
                .style("opacity", 1);
            });
           
            ylegend = ylegend + 20;
      
            elem.selectAll("dot")
            .data(emotion)
            .enter().append("circle")
            .attr("r", 4)
            .attr("id", myemotion+"dot")
            .attr("fill", colorScale[mycolor])
            .attr("cx", function(d,i) { return XLinearScale(i+1); })
            .attr("cy", function(d) { return yLinearScale(d); })
            .style('opacity', 0.7)
            .style('stroke-width', 0.3)
            .on('mouseover',function(d,i){
               // mygamedata_country = mygamedata.filter(function(i) { return i.Country == d["properties"]["name"]; });
                
               // if(mygamedata_country.length !=0){
                   tip.show(d,i);
                d3.select(this)
                .style('opacity', 1)
                .attr("r", 7)
                .style('stroke-width', 3);
                
            })
            .on('mouseout', function(d){
               tip.hide(d);
                d3.select(this)
                .style('opacity', 0.7)
                .attr("r", 4)
                .style('stroke-width',0.3);
            });;


            mycolor = mycolor+1;

   })


             elem.append("text")      // text label for the x axis
                    .attr("x", 350 )
                    .attr("y",  400 )
                    .style("text-anchor", "middle")
                    .text("Chunk");
                elem.append("text")      // text label for the y axis
                    .attr("transform", "rotate(-90)")
                    .attr("x", -200 )
                    .attr("y",  15 )
                    .style("text-anchor", "middle")
                    .text("Emotion Fraction");
                elem.append("text")      // text label for the title
                    .attr("x", 350 )
                    .attr("y",  10 )
                    .style("text-anchor", "middle")
                    .text("Sentiment Analysis of "+ "'" + apidata["Title"].slice(0,45) + "'");

            var bottomAxis = d3.axisBottom(XLinearScale);
            var leftAxis = d3.axisLeft(yLinearScale); 
           
            elem.append("g")
            .classed("axis", true)
            .attr("id", "leftaxis")
            .attr("transform", `translate(100, 0)`)
            .call(leftAxis);

            elem.append("g")
				.attr("class", "x axis")
                .attr("id", "bottomaxis")
				.attr("transform", "translate(0," + 350 + ")")
				.call(bottomAxis);

   }

//reads csv and calls function to add graphs
    d3.dsv(",", pathToCsv, function (d) {
      return {

        chunk: parseInt(d["chunk"]),
        anger: parseFloat(d["anger"]),
        anticipation: parseFloat(d["anticipation"]),
        disgust: parseFloat(d["disgust"]),
        fear: parseFloat(d["fear"]),
        joy: parseFloat(d["joy"]),
        negative: parseFloat(d["negative"]),
        positive: parseFloat(d["positive"]),
        sadness: parseFloat(d["sadness"]),
        surprise: parseFloat(d["surprise"]),
        trust: parseFloat(d["trust"]),
        book: d["book"],
        Query: d["Query"],
        Filename: d["Filename"],
        ISBN13: d["ISBN13"],
        Title: d["book_updated"],
        Author: d["Author"],
        PublishedDate: d["PublishedDate"],
        ImgURL: d["ImgURL"],
        NumPages: d["NumPages"],
        AvgRtg: d["AvgRtg"],
        Description: d["Description"],
        BuyLink: d["BuyLink"],
        Price: d["Price"],
        Currency: d["Currency"],
        TopEmotion1: d["TopEmotion1"],
        TopEmotion2: d["TopEmotion2"],
        TopEmotion3: d["TopEmotion3"],
        Similar1: d["Most Similar Book"],
        Similar2: d["2nd Most Similar Book"],
        Similar3: d["3rd Most Similar Book"]

      }
    }).then(function (data) {
      console.log(data); // you should see the data in your browser's developer tools console 
      var allcolumns = Object.keys(data[0]);
        var allemotions = allcolumns.slice(1,11);

      console.log(allemotions);
      allemotions = ["anger",  "anticipation" , "disgust",  "fear", "joy", "sadness",  "surprise", "trust"];
      var posneg = ["positive", "negative"];

   // add the options to the button
   var distinctbooks = [...new Set(data.map(x=> x.Title))];
   distinctbooks = distinctbooks.sort();
 
       console.log(distinctbooks);
//generate initial page
  creategraph(data, distinctbooks[1408], allemotions, svg); 

    d3.select("#myDropdown")
      .selectAll('myOptions')
     	.data(distinctbooks)
      .enter()
        .append('a')
      .text(function (d) { return d; }) // text showed in the menu
      .attr("id", function (d) { return d; })
      .attr("value", function (d) { return d; })// corresponding value returned by the button
      .attr("class", "myopt")    
      .on('mouseover',function(d,i){

            d3.select(this)
            .style("color", "red");
            ;})
        .on('mouseout',function(d,i){

            d3.select(this)
            .style("color", "black");})
        .on('click',function(d,i){
            
            d3.select(this)
            .style("color", "blue");
            console.log(this)
           
            creategraph(data, this["id"], allemotions, svg)
            myFunction();});
    


    }).catch(function (error) {
      console.log(error);
    });

</script>

</body>